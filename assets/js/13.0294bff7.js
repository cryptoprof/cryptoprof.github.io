(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{508:function(e,n,a){"use strict";a.r(n);var t=a(6),s=Object(t.a)({},(function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("Давно не писал в блог. Напишу что делал из последнего. Потребовалось прикрутить возможность просмотра документов .doc,.docx,.xls,.xlsx на сайте. Знаю про сервис, который предоставляет google.docs, но мне не хотелось с ним связываться-так как сайт госконторы. У яндекса есть возможность передавать в качестве get параметра ссылку на ваш документ таким образом:")]),e._v(" "),a("p",[e._v("https://docviewer.yandex.ru/?url=адрес с файлом")]),e._v(" "),a("p",[e._v("Мне же необходимо было применить эти изменения ко всем ссылкам на сайте, в адресе которых содержится .doc или .xls. Получился скрипт такого плана:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('<script type = "text/javascript">\n    //Скрипт для вывода кнопки просмотра документов .doc,.docx,.xls,.xlsx на сервисе Яндекса\n\n    window.onload = function(){\n \n        var As = document.getElementsByTagName("a");\n\n        for(var i = 0, l = As.length; i < l; i ++){\n            mylink=document.getElementsByTagName("a")[i].href;\n            myinner=document.getElementsByTagName("a")[i].innerHTML;\n \n            if (document.getElementsByTagName("a")[i].className.search(\'yaviewer\')==-1){\n                if (document.getElementsByTagName("a")[i].href.search(\'.doc\')!=-1){\n                     document.getElementsByTagName("a")[i].innerHTML=" <a class=\'yaviewer2\' href=\'"+mylink+"\'>"+myinner+"</a><a href=https://docviewer.yandex.ru/?url="+mylink+" target=\'_blank\' class=\'yaviewer\'>Просмотреть</a>";\n                }\n                if (document.getElementsByTagName("a")[i].href.search(\'.xls\')!=-1){\n                    document.getElementsByTagName("a")[i].innerHTML=" <a class=\'yaviewer2\' href=\'"+mylink+"\'>"+myinner+"</a><a href=https://docviewer.yandex.ru/?url="+mylink+" target=\'_blank\' class=\'yaviewer\'>Просмотреть</a>";\n                }\n            }\n \n        }\n    }\n<\/script>')])])])])}),[],!1,null,null,null);n.default=s.exports}}]);